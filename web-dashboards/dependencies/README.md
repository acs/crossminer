# Dependencies Dashboard

The dependencias dashboard shows a network graph with the dependencies between
items in CROSSMINER projects.

In the current version it shows the dependencies between the bundles of a Java
projects. The data with the dependencies is generated by CWI partner. If you want to test all, just ask for them because they are not public yet.

## Install Elasticsearch and Kibana

An Elasticsearch and Kibana services are needed. docker-compose can be used to start them.

Elasticsearch needs this config:

`sudo sh -c "echo 262144 > /proc/sys/vm/max_map_count"`

The contents of the `docker-compose.yml` file to be used is:

```
cat docker-compose.yml
elasticsearch:
  image: bitergia/elasticsearch:5.6.0
  command: /elasticsearch/bin/elasticsearch -E network.bind_host=0.0.0.0
  ports:
    - "9200:9200"
  environment:
    - ES_JAVA_OPTS=-Xms2g -Xmx2g

kibiter:
  image: bitergia/kibiter:5.6.0
  links:
    - elasticsearch
  ports:
   - "5601:5601"
  environment:
    - ELASTICSEARCH_USER=bitergia
    - ELASTICSEARCH_PASSWORD=bitergia
    - NODE_OPTIONS=--max-old-space-size=1000
```

To start both services:

`docker-compose -f docker-compose.yml up kibiter`


## Install

The data processing is done with GrimoireLab python platform.

A virtual env in Python is used to install the tools needed.

In Debian/Ubuntu you need to execute:

`sudo apt-get install python3-venv`

To create the python virtualenv and activate it:

```
mkdir ~/venvs
python3 -m venv ~/venvs/crossminer
source ~/venvs/crossminer/bin/activate
pip3 install grimoire-elk
```



Now the tool can be executed with:

```
./dependencies2es.py  -f eclipse4.6-draft-corpus/json/requiredBundles.json -e http://bitergia:bitergia@localhost:9200 -i dependencies
2017-11-28 12:43:47,415 Importing items from eclipse4.6-draft-corpus/json/requiredBundles.json to http://bitergia:bitergia@localhost:9200/dependencies
2017-11-28 12:43:47,423 Loading dependencies in Elasticsearch ...
2017-11-28 12:43:47,427 Import all JSON items with dependencies from: eclipse4.6-draft-corpus/json/requiredBundles.json
2017-11-28 12:43:49,807 Import completed.
```

And now the Kibana panel can be imported to show the data:

`kidash.py -e http://bitergia:bitergia@localhost:9200 --import panels/dependencies.json`

The panel is ready at the URL:

http://localhost:5601/app/kibana#/dashboard/AV7m5g5kfuk55ZFAddq4

![](screenshot.png?raw=true)
